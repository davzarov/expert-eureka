{% extends "base.html" %}

{% load static humanize %}

{% block title %}Productos | {{block.super}}{% endblock title %}

{% block extra_css %}
  <style>
    .tabs .tab a {
      color: #26a69a;
    }
    .tabs .tab a.active {
      color: #26a69a;
    }
    .tabs .tab a:hover {
      color: #26a69a;
    }
    .tabs .tab a:focus {
      background-color: rgba(0, 255, 0, 0.1);
    }
    .tabs .tab a:focus.active {
      background-color: rgba(0, 255, 0, 0.1);
    }
    .tabs .indicator {
      background-color: #26a69a;
    }
  </style>
{% endblock extra_css %}

{% block content %}
  <div class="row">
    <div class="col s12">
      <a href="{% url 'inventario:crear' %}" class="btn waves-effect waves-light mb-4">
        <i class="material-icons left">add</i> Producto
      </a>
      <a href="{% url 'inventario:categoria' %}" class="btn waves-effect waves-light mb-4">
          <i class="material-icons left">add</i> Categoría
      </a>
    </div>
  </div>
  {% if categorias %}
    <div class="row">
      <div class="col s12">
        <ul class="tabs">
          {% for categoria in categorias %}
            <li class="tab col s3">
              <a class="active" href="#categoria{{categoria.id}}">{{categoria}}</a>
            </li>
          {% endfor %}
        </ul>
      </div>
      {% for categoria in categorias %}
        <div id="categoria{{categoria.id}}" class="col s12">
          <div class="row">
            {% if categoria.get_productos %}
              {% for producto in categoria.get_productos %}
                <div class="col m4 s12">
                  <div class="card sticky-action">
                    <div class="card-image waves-effect waves-block waves-light">
                      {% if producto.imagen %}
                        <img class="activator" src="{{producto.imagen.url}}">
                      {% else %}
                        <img class="activator" src="{% static 'img/noimage.jpg' %}">
                      {% endif %}
                    </div>
                    <div class="card-content">
                      <span class="card-title activator grey-text text-darken-4">
                        {{producto.nombre|truncatechars:12}}
                        <i class="material-icons right">more_vert</i>
                      </span>
                      <p>Cantidad: {{producto.cantidad}}</p>
                      <p>Precio: &#8370; {{producto.precio_costo|intcomma}}</p>
                    </div>
                    <div class="card-action">
                      <a href="{{producto.get_absolute_url}}" class="teal-text">
                        Detalles
                      </a>
                      <a href="{% url 'inventario:actualizar' producto.id %}" class="teal-text">
                        Modificar
                      </a>
                    </div>
                    <div class="card-reveal">
                      <span class="card-title grey-text text-darken-4">{{producto.nombre}}<i class="material-icons right">close</i></span>
                      <p>{{producto.descripcion}}</p>
                    </div>
                  </div>
                </div>
              {% endfor %}
            {% else %}
              <div class="col s12">
                <div class="card z-depth-0">
                  <div class="card-content">
                    <span class="card-title center-align">No existen productos para esta categoría</span>
                  </div>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="col s12">
      <div class="card z-depth-0">
        <div class="card-content">
          <span class="card-title center-align">No existen datos</span>
        </div>
      </div>
    </div>
  {% endif %}
{% endblock content %}

{% block extra_js %}
  {{block.meta}}
  var tabs = M.Tabs.init(document.querySelector('.tabs'));
{% endblock extra_js %}